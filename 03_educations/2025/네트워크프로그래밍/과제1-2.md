
---

**📘 리눅스에서 socket(AF_INET, SOCK_STREAM, 0) 호출 시 내부 동작 분석 보고서**

---

**✅ 1. 개요**

  

socket() 함수는 네트워크 통신을 위한 소켓을 생성하는 시스템 호출이다.

리눅스에서는 이 함수 호출 시 내부적으로 커널 영역의 여러 함수를 순차적으로 호출하여 소켓을 생성하고,

이 소켓을 제어할 수 있도록 파일 디스크립터(FD)를 반환한다.

  

본 보고서는 socket() 함수 호출 시 내부적으로 호출되는 **sub 함수들의 실행 흐름**,

그리고 **각 함수가 왜 호출되는지(호출 목적)**에 대해 분석한다.

---

**✅ 2. 함수 호출 흐름 및 호출 이유 (번호 및 설명 포함)**

|**번호**|**함수 이름**|**역할 요약**|**호출 이유 (왜 필요한가?)**|
|---|---|---|---|
|**①**|socket()|사용자 프로그램이 호출하는 소켓 생성 함수|네트워크 통신용 소켓을 생성하기 위해 호출|
|**②**|sys_socket()|시스템 콜 인터페이스|유저 공간에서 커널 공간으로 진입하기 위해|
|**③**|__sys_socket()|시스템 콜 내부 로직|인자 검사 및 커널 소켓 생성 로직 진입을 위해|
|**④**|sock_create()|도메인/타입/프로토콜 기반 소켓 생성 요청|요청 정보에 맞는 소켓 구조를 만들기 위해|
|**⑤**|net_families[AF_INET]->create()(예: inet_create())|실제 TCP/IP용 소켓 생성 함수 호출|AF_INET(TCP/IP)에 맞는 구조 설정을 위해|
|**⑥**|sock_alloc()|커널 소켓 구조체 메모리 할당|소켓을 커널 내부에 물리적으로 생성하기 위해|
|**⑦**|sock_init_data()|내부 데이터 초기화|수신 큐, 송신 큐 등 소켓의 상태를 초기 세팅하기 위해|
|**⑧**|security_socket_create()|보안 검사 (SELinux 등)|시스템 보안 정책 위반 여부를 검사하기 위해|
|**⑨**|sock_alloc_file()|파일 디스크립터 생성 및 반환|사용자에게 제어할 수 있는 소켓 핸들(FD)을 제공하기 위해|

  

---

**✅ 3. 함수 호출 흐름도 (Graph)**

```
[①] socket()
   ↓
[②] sys_socket()
   ↓
[③] __sys_socket()
   ↓
[④] sock_create()
   ↓
[⑤] net_families[AF_INET]->create()    ← ex) inet_create()
   ↓
[⑥] sock_alloc()
   ↓
[⑦] sock_init_data()
   ↓
[⑧] security_socket_create()
   ↓
[⑨] sock_alloc_file()
   ↓
리턴: 소켓 파일 디스크립터 (ex. 3)
```

  

---

**✅ 4. 결론**

• socket() 하나의 호출 뒤에는 커널 내부에서 **총 9개 이상의 단계**가 순차적으로 수행된다.

• 이 과정은 단순한 메모리 생성이 아니라, **도메인 분석**, **구조체 설정**, **보안 검사**, **FD 등록**까지 포함된 복합적인 작업이다.

• 이를 정확히 이해하면 네트워크 프로그래밍에서 발생 가능한 문제를 더 잘 디버깅하고 시스템 레벨 이해도를 높일 수 있다.

---

**✅ 5. 참고 소스 경로**

• 커널 구현: [Linux GitHub 커널](https://github.com/torvalds/linux)

• 관련 파일 예시:

• net/socket.c

• net/ipv4/af_inet.c

• include/linux/net.h

• include/net/sock.h

---

이제 이 내용 그대로 복사해서 워드/한글 파일에 붙여 넣으면 완성이에요 🎓

원하시면 제가 이걸 Word나 PDF로 만들어 드릴 수도 있어요.

필요하면 “보고서 파일 만들어줘!” 라고 말해줘요! 😄